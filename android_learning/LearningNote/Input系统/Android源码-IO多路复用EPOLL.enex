<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE en-export SYSTEM "http://xml.evernote.com/pub/evernote-export3.dtd">
<en-export export-date="20171124T092308Z" application="Evernote" version="Evernote Mac 6.12.2 (455489)">
<note><title>Android源码-IO多路复用EPOLL</title><content><![CDATA[<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE en-note SYSTEM "http://xml.evernote.com/pub/enml2.dtd">
<en-note><div>1.IO多路复用之epoll总结</div><div><br/></div><div>1)基本知识</div><div> epoll是在2.6内核中提出的，是之前的select和poll的增强版本。相对于select和poll来说，epoll更加灵活，没有描述符的限制。epoll使用一个文件描述符管理多个描述符，将用户关系的文件描述符的事件存放到内核的一个事件表中，这样在用户空间和内核空间的copy只需一次。</div><div><br/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div>epoll_event的结构体</div><div>typedef union epoll_data</div><div>{</div><div>  void *ptr;</div><div>  int fd;</div><div>  uint32_t u32;</div><div>  uint64_t u64;</div><div>} epoll_data_t;</div><div><br/></div><div>struct epoll_event</div><div>{</div><div>  uint32_t events; /* Epoll events */</div><div>  epoll_data_t data; /* User data variable */</div><div>};</div></div><div><br/></div><div>2)epoll接口</div><div>epoll操作过程需要三个接口，分别如下</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div>#include&lt;sys/epoll.h&gt;</div><div>int epoll_create(int size);</div><div>int epoll_ctl(int epfd, int op, int fd, struct epoll_event *event);</div><div>int epoll_wait(int epfd, struct epoll_event *events, int maxevents, int timeout);</div></div><div><br/></div><div><br/></div><div><span style="font-weight: bold; color: rgb(45, 79, 201);">(1)int epoll_create(int size);</span></div><div>创建一个epoll的句柄，size用来告诉内核这个监听的数目一共有多大。这个参数不同于select()中的第一个参数，给出最大监听的fd+1的值。需要注意的是，当创建好epoll句柄后，它就是会占用一个fd的值，在linux下如果查看/proc/进程id/fd/,是能够看到这个fd的，所以在使用完epoll后，必须调用close()关闭掉，否则可能导致fd被耗尽。</div><div><br/></div><div><span style="font-weight: bold; color: rgb(45, 79, 201);">(2)int epoll_ctl(int epfd, int op ,int fd, struct epoll_event* event);</span></div><div>     epoll的事件注册函数，它不同于select()是在监听事件时告诉内核要监听什么类型事件，而是在这里先注册要监听的事件类型。第一个是epoll_create()的返回值，第二个参数表示动作，用三个宏表示：</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div>EPOLL_CTL_ADD:注册新的fd到epfd中;</div><div>EPOLL_CTL_MOD:修改已经注册的fd监听事件;</div><div>EPOLL_CTL_DEL:从epfd中删除一个fd;</div></div><div><br/></div><div>第三个参数是需要监听的fd，第四个参数是告诉内核需要监听什么事件，</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div>struct epoll_event的结构如下：</div><div>struct epoll_event{</div><div>     _uint32_t event;//Epoll events;</div><div>     epoll_data_t data;//User data variable</div><div>}</div></div><div><br/></div><div>events可以是以下几个宏的集合：</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div>EPOLLIN：表示对应的文件描述符可读（包括对端SOCKET正常关闭）;</div><div>EPOLLOUT:表示对应的文件描述符可写;</div><div>EPOLLPRI:表示对应的文件描述符有紧急的数据可读（这里应该表示有带外数据到来）;</div><div>EPOLLERR:表示对应的文件描述符发送错误;</div><div>EPOLLHUP:表示对应的文件描述符被挂断;</div><div>EPOLLET:将EPOLL设为边缘触发（Edge Triggered）模式，这是相对于水平触发（Level Triggered）来说的。</div><div>EPOLLONESHOT：只监听一次事件，当监听完这次事件之后，如果还需要继续监听这个socket的话，需要再次将这个socket加入到EPOLL队列里。</div></div><div><br/></div><div><span style="font-weight: bold; color: rgb(45, 79, 201);">(3)int epoll_wait(int epfd, struct epoll_event* events, int maxevents, int timeout);</span></div><div>     等待事件的产生，类似select()调用。参数events用来从内核得到事件的集合，maxevents告诉这个events有多大，这个maxevents的值不能大于创建epoll_create()时的size，参数timeout是超时时间（毫秒，0立即返回，-1是永久阻塞）。该函数返回需要处理的事件数目，如返回0表示已超时。</div><div><br/></div><div>3)工作模式</div><div>     epoll对文件描述符的操作有两种模式：LT(level trigger)和ET(edge trigger).LT模式是默认模式，LT模式与ET模式的区别如下：</div><div>     <span style="color: rgb(255, 0, 0);">LT模式：当epoll_wait检测到描述符事件发生并将此事件通知应用程序，应用程序可以不立即处理该事件。下次调用epoll_wait时，会再次响应应用程序并通知此事件。</span></div><div><span style="color: rgb(255, 0, 0);">     ET模式：当epoll_wait检测到描述符事件发生并将此事件通知应用程序，应用程序必须立即处理该事件。如果不处理，下次调用epoll_wait时，不会再次响应应用程序并通知此事件。</span></div><div>     <span style="color: rgb(45, 79, 201);">ET模式在很大程度上减少了epoll事件被重复触发的次数，因此效率要比LT模式高，epoll工作在ET模式的时候，必须使用非阻塞套接接口，以避免由于一个文件句柄的阻塞读/写操作吧多个文件处理描述符的任务饿死。</span></div><div><br/></div><div>4.测试代码</div><div>     编写一个服务器回射程序echo，联系epoll过程。</div><div>服务端的代码如下：</div><div><en-media style="cursor:pointer;" hash="a29cb6653d61093e8319da3efd061fd5" type="application/octet-stream"/></div><div>客户端的代码如下：</div><div><en-media style="cursor:pointer;" hash="6078c321579bb8b9e6e4570c00493043" type="application/octet-stream"/></div><div><br/></div><div>需要运行起来看下效果。</div><div><br/></div><div><a href="http://blog.csdn.net/yangwen123/article/details/14119195">http://blog.csdn.net/yangwen123/article/details/14119195</a></div><div><br/></div></en-note>
]]></content><created>20170819T025819Z</created><updated>20170831T065607Z</updated><note-attributes><author>1009439210@qq.com</author><source>desktop.win</source><source-application>evernote.win32</source-application><reminder-order>1503152370000</reminder-order><reminder-time>20170821T022000Z</reminder-time></note-attributes><resource><data encoding="base64">I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+
DQojaW5jbHVkZSA8ZXJybm8uaD4NCg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxz
eXMvc29ja2V0Lmg+DQojaW5jbHVkZSA8YXJwYS9pbmV0Lmg+DQojaW5jbHVkZSA8c3lzL2Vwb2xsLmg+
DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQoNCiNkZWZpbmUgTUFY
U0laRSAJMTAyNDsNCiNkZWZpbmUgSVBBRERSRVNTIAkiMTI3LjAuMC4xIg0KI2RlZmluZSBTRVJWX1BP
UlQgCTg3ODcNCiNkZWZpbmUgRkRTSVpFCQkxMDI0DQojZGVmaW5lIEVQT0xMRVZFTlRTCTIwDQoNCnN0
YXRpYyB2b2lkIGhhbmRsZV9jb25uZWN0aW9uKGludCBzb2NrZmQpOw0KDQpzdGF0aWMgdm9pZCBoYW5k
bGVfZXZlbnRzKGludCBlcG9sbGZkLCBzdHJ1Y3QgZXBvbGxfZXZlbnQqIGV2ZW50LCBpbnQgbnVtLCBp
bnQgc29ja2ZkLCBjaGFyICpidWYpOw0KDQpzdGF0aWMgdm9pZCBkb19yZWFkKGludCBlcG9sbGZkLCBp
bnQgZmQsIGludCBzb2NrZmQsIGNoYXIgKmJ1Zik7DQoNCnN0YXRpYyB2b2lkIGRvX3dyaXRlKGludCBl
cG9sbGZkLCBpbnQgZmQsIGludCBzb2NrZmQsIGNoYXIgKmJ1Zik7DQoNCnN0YXRpYyB2b2lkIGFkZF9l
dmVudChpbnQgZXBvbGxmZCwgaW50IGZkLCBpbnQgc3RhdGUpOw0KDQpzdGF0aWMgdm9pZCBkZWxldGVf
ZXZlbnQoaW50IGVwb2xsZmQsIGludCBmZCwgaW50IHN0YXRlKTsNCg0Kc3RhdGljIHZvaWQgbW9kaWZ5
X2V2ZW50KGludCBlcG9sbGZkLCBpbnQgZmQsIGludCBzdGF0ZSk7DQoNCmludCBtYWluKGludCBhcmdj
ICxjaGFyICphcmd2W10pew0KCWludCBzb2NrZmQ7DQoJc3RydWN0IHNvY2thZGRyX2luIHNlcnZhZGRy
Ow0KCXNvY2tmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgMCk7DQoJYnplcm8oJnNlcnZh
ZGRyLCBzaXplb2Yoc2VydmFkZHIpKTsNCglzZXJ2YWRkci5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCglz
ZXJ2YWRkci5zaW5fcG9ydCA9IGh0b25zKFNFUlZfUE9SVCk7DQoJaW5ldF9wdG9uKEFGX0lORVQsIElQ
QUREUkVTUywgJnNlcnZhZGRyLnNpbl9hZGRyKTsNCgljb25uZWN0KHNvY2tmZCwgKHN0cnVjdCBzb2Nr
YWRkciAqKSZzZXJ2YWRkciwgc2l6ZW9mKHNlcnZhZGRyKSk7DQoJLy/lpITnkIbov57mjqUNCgloYW5k
bGVfY29ubmVjdGlvbihzb2NrZmQpOw0KCWNsb3NlKHNvY2tmZCk7DQoJcmV0dXJuIDA7DQp9DQoNCnN0
YXRpYyB2b2lkIGhhbmRsZV9jb25uZWN0aW9uKGludCBzb2NrZmQpew0KCWludCBlcG9sbGZkOw0KCXN0
cnVjdCBlcG9sbF9ldmVudCBldmVudHNbRVBPTExFVkVOVFNdOw0KCWNoYXIgYnVmW01BWFNJWkVdOw0K
CWludCByZXQ7DQoJZXBvbGxmZCA9IGVwb2xsX2NyZWF0ZShGRFNJWkUpOw0KCWFkZF9ldmVudChlcG9s
bGZkLCBzb2NrZmQsIEVQT0xMSU4pOw0KCWZvcig7Oyl7DQoJCXJldCA9IGVwb2xsX3dhaXQoZXBvbGxm
ZCwgZXZlbnRzLCBFUE9MTEVWRU5UUywgLTEpOw0KCQloYW5kbGVfZXZlbnRzKGVwb2xsZmQsIGV2ZW50
cyxyZXQsIHNvY2tmZCwgYnVmKTsNCgl9DQoJY2xvc2UoZXBvbGxmZCk7DQp9DQoNCnN0YXRpYyB2b2lk
IGhhbmRsZV9ldmVudHMoaW50IGVwb2xsZmQsIHN0cnVjdCBlcG9sbF9ldmVudCogZXZlbnQsIGludCBu
dW0sIGludCBzb2NrZmQsIGNoYXIgKmJ1Zil7DQoJaW50IGZkOw0KCWludCBpOw0KCWZvcihpID0gMDsg
aSA8IG51bSA7aSsrICl7DQoJCWZkID0gZXZlbnRzW2ldLmRhdGEuZmQ7DQoJCWlmKGV2ZW50c1tpXS5l
dmVudHMgJiBFUE9MTElOKXsNCgkJCWRvX3JlYWQoZXBvbGxmZCwgZmQsIHNvY2tmZCwgYnVmKTsNCgkJ
fWVsc2UgaWYoZXZlbnRzW2ldLmV2ZW50cyAmIEVQT0xMT1VUKXsNCgkJCWRvX3dyaXRlKGVwb2xsZmQs
IGZkLCBzb2NrZmQsIGJ1Zik7DQoJCX0NCgl9DQp9DQpzdGF0aWMgdm9pZCBkb19yZWFkKGludCBlcG9s
bGZkLCBpbnQgZmQsIGludCBzb2NrZmQsIGNoYXIgKmJ1Zil7DQoJaW50IG5yZWFkOw0KCW5yZWFkID0g
cmVhZChmZCwgYnVmLCBNQVhTSVpFKTsNCglpZihucmVhZCA9PSAtMSl7DQoJCXBlcnJvcigicmVhZCBl
cnJvcjoiKTsNCgkJY2xvc2UoZmQpOw0KCX1lbHNlIGlmKG5yZWFkID09IDApew0KCQlmcHJpbnRmKHN0
ZGVyciwgInNldmVyIGNsb3NlLlxuIik7DQoJCWNsb3NlKGZkKTsNCgl9ZWxzZSB7DQoJCWlmKGZkID09
IFNURElOX0ZJTEVOTyl7DQoJCQlhZGRfZXZlbnQoZXBvbGxmZCwgc29ja2ZkLCBFUE9MTE9VVCk7DQoJ
CX1lbHNlIHsNCgkJCWRlbGV0ZV9ldmVudChlcG9sbGZkLCBzb2NrZmQsIEVQT0xMSU4pOw0KCQkJYWRk
X2V2ZW50KGVwb2xsZmQsIFNURE9VVF9GSUxFTk8sIEVQT0xMT1VUKTsNCgkJfQ0KCX0NCn0NCg0Kc3Rh
dGljIHZvaWQgZG9fd3JpdGUoaW50IGVwb2xsZmQsIGludCBmZCwgaW50IHNvY2tmZCwgY2hhciAqYnVm
KXsNCglpbnQgbndyaXRlOw0KCW53cml0ZSA9IHdyaXRlKGZkLCBidWYsIHN0cmxlbihidWYpKTsNCglp
Zihud3JpdGUgPT0gLTEpew0KCQlwZXJyb3IoIndyaXRlIGVycm9yOiIpOw0KCQljbG9zZShmZCk7DQoJ
fWVsc2Ugew0KCQlpZihmZCA9PSBTVERPVVRfRklMRU5PKXsNCgkJCWRlbGV0ZV9ldmVudChlcG9sbGZk
LCBmZCwgRVBPTExPVVQpOw0KCQl9ZWxzZSB7DQoJCQltb2RpZnlfZXZlbnQoZXBvbGxmZCwgZmQsIEVQ
T0xMSU4pOw0KCQl9DQoJfQ0KCW1lbXNldChidWYsIDAgLCBNQVhTSVpFKTsNCn0NCg0Kc3RhdGljIHZv
aWQgYWRkX2V2ZW50KGludCBlcG9sbGZkLCBpbnQgZmQsIGludCBzdGF0ZSl7DQoJc3RydWN0IGVwb2xs
X2V2ZW50IGV2Ow0KCWV2LmV2ZW50cyA9IHN0YXRlOw0KCWV2LmRhdGEuZmQgPSBmZDsNCgllcG9sbF9j
dGwoZXBvbGxmZCwgRVBPTExfQ1RMX0FERCwgZmQsICZldik7DQp9DQoNCnN0YXRpYyB2b2lkIGRlbGV0
ZV9ldmVudChpbnQgZXBvbGxmZCwgaW50IGZkLCBpbnQgc3RhdGUpew0KCXN0cnVjdCBlcG9sbF9ldmVu
dCBldjsNCglldi5ldmVudHMgPSBzdGF0ZTsNCglldi5kYXRhLmZkID0gZmQ7DQoJZXBvbGxfY3RsKGVw
b2xsZmQsIEVQT0xMX0NUTF9ERUwsIGZkLCAmZXYpOw0KfQ0KDQpzdGF0aWMgdm9pZCBtb2RpZnlfZXZl
bnQoaW50IGVwb2xsZmQsIGludCBmZCwgaW50IHN0YXRlKXsNCglzdHJ1Y3QgZXBvbGxfZXZlbnQgZXY7
DQoJZXYuZXZlbnRzID0gc3RhdGU7DQoJZXYuZGF0YS5mZCA9IGZkOw0KCWVwb2xsX2N0bChlcG9sbGZk
LCBFUE9MTF9DVExfTU9ELCBmZCwgJmV2KTsNCn0=</data><mime>application/octet-stream</mime><duration>0</duration><resource-attributes><source-url>file://D:\android_framworksource\Android触摸事件的处理\epoll_client.cpp</source-url><timestamp>19700101T000000Z</timestamp><file-name>epoll_client.cpp</file-name><attachment>true</attachment></resource-attributes></resource><resource><data encoding="base64">I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RkbGliLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+
DQojaW5jbHVkZSA8ZXJybm8uaD4NCg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxz
eXMvc29ja2V0Lmg+DQojaW5jbHVkZSA8YXJwYS9pbmV0Lmg+DQojaW5jbHVkZSA8c3lzL2Vwb2xsLmg+
DQojaW5jbHVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQoNCiNkZWZpbmUgSVBB
RERSRVNTIAkiMTI3LjAuMC4xIg0KI2RlZmluZSBQT1JUCQk4Nzg3DQojZGVmaW5lIE1BWFNJWkUJCTEw
MjQNCiNkZWZpbmUJTElTVEVOUQkJNQ0KI2RlZmluZSBGRFNJWkUJCTEwMDANCiNkZWZpbmUgRVBPTExF
VkVOVFMgMTAwDQoNCi8v5Ye95pWw5aOw5piODQovL+WIm+W7uuWll+aOpeWtl+W5tui/m+ihjOe7keWu
mg0Kc3RhdGljIGludCBzb2NrZXRfYmluZChjb25zdCBjaGFyKiBpcCwgaW50IHBvcnQpOw0KDQovL0lP
5aSa6Lev5aSN55SoZXBvbGwNCnN0YXRpYyB2b2lkIGRvX2Vwb2xsKGludCBsaXN0ZW5mZCk7DQoNCi8v
5LqL5Lu25aSE55CG5Ye95pWwDQpzdGF0aWMgdm9pZCBoYW5kbGVfZXZlbnRzKGludCBlcG9sbGZkLCBz
dHJ1Y3QgZXBvbGxfZXZlbnQgKmV2ZW50cywgaW50IG51bSwgaW50IGxpc3RlbmZkLCBjaGFyICpidWYp
Ow0KDQovL+WkhOeQhuaOpeaUtueahOi/nuaOpQ0Kc3RhdGljIHZvaWQgaGFuZGxlX2FjY2VwdChpbnQg
ZXBvbGxmZCwgaW50IGxpc3RlbmVmZCk7DQoNCi8v6K+75pON5L2cDQpzdGF0aWMgdm9pZCBkb19yZWFk
KGludCBlcG9sbGZkLCBpbnQgZmQsIGNoYXIqIGJ1Zik7DQoNCi8v5YaZ5pON5L2cDQpzdGF0aWMgdm9p
ZCBkb193cml0ZShpbnQgZXBvbGxmZCwgaW50IGZkLCBjaGFyKiBidWYpOw0KDQovL+a3u+WKoOS6i+S7
tg0Kc3RhdGljIHZvaWQgYWRkX2V2ZW50KGludCBlcG9sbGZkLCBpbnQgZmQsIGludCBzdGF0ZSk7DQoN
Ci8v5L+u5pS55LqL5Lu2DQpzdGF0aWMgdm9pZCBtb2RpZnlfZXZlbnQoaW50IGVwb2xsZmQsIGludCBm
ZCwgaW50IHN0YXRlKTsNCg0KLy/liKDpmaTkuovku7YNCnN0YXRpYyB2b2lkIGRlbGV0ZV9ldmVudChp
bnQgZXBvbGxmZCwgaW50IGZkLCBpbnQgc3RhdGUpOw0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAq
YXJndltdKQ0Kew0KCWludCBsaXN0ZW5mZDsNCglsaXN0ZW5mZCA9IHNvY2tldF9iaW5kKElQQUREUkVT
UywgUE9SVCk7DQoJbGlzdGVuKGxpc3RlbmZkLCBMSVNURU5RKTsNCglkb19lcG9sbChsaXN0ZW5mZCk7
DQoJcmV0dXJuIDA7DQp9DQoNCi8v5Yib5bu65aWX5o6l5a2X5bm26L+b6KGM57uR5a6aDQpzdGF0aWMg
aW50IHNvY2tldF9iaW5kKGNvbnN0IGNoYXIqIGlwLCBpbnQgcG9ydCkNCnsNCglpbnQgbGlzdGVuZmQ7
DQoJc3RydWN0IHNvY2tldGFkZHJfaW4gc2VyYWRkcjsNCgkvKg0KCQluZXRpbm5ldC9pbi5oDQoJCXN0
cnVjdCBzb2NrZXRhZGRfaW4NCgkJew0KCQkJc2hvcnQgc2luX2ZhbWlseTsvL0FkZHJlc3NmYW1pbHnk
uIDoiKzmnaXor7RBRl9JTkVUKOWcsOWdgOaXjylQRl9JTkVUKOWNj+iuruaXjykNCgkJCXVuc2lnbmVk
IHNob3J0IHNpbl9wb3J0Oy8vUG9ydG51bWJlcijlv4Xpobvph4fnlKjnmoTnvZHnu5zmlbDmja7moLzl
vI/vvIzmma7pgJrmlbDlrZflj6/ku6XnlKhodG9ucygp5Ye95pWw6L2s5o2i5oiQ572R57uc5pWw5o2u
5qC85byP55qE5pWw5a2XKQ0KCQkJc3RydWN0IGluX2FkcnIgc2luX2FkZHI7Ly9JbnRlcm5ldGFkZHJl
c3M7DQoJCQl1bnNpbmdlZCBjaGFyIHNpbl96ZXJvWzhdOy8vU2FtZXNpemVhc3N0cnVjdHNvY2thZGRy
5rKh5pyJ5a6e6ZmF5oSP5LmJ77yM5Y+q5piv5Li65LqG6LefU09DS0FERFLnu5PmnoTlnKjlhoXlrZjk
uK3lr7npvZANCgkJfQ0KCSovDQoJbGlzdGVuZmQgPSBzb2NrZXQoQUZfSU5FVCwgU09DS0VUX1NUUkVB
TSwgMCk7DQoJaWYobGlzdGVuZmQgPT0gLTEpew0KCQlwZXJyb3IoInNvY2tldCBlcnJvcjoiKTsNCgkJ
ZXhpdCgxKTsNCgl9DQoJLy/nva7lrZfoioLlrZfnrKbkuLLliY1u5Liq55u05o6l5Li6MO+8jOWMheaL
rCdcMCcNCgliemVybygmc2VyYWRkciwgc2l6ZW9mKHNlcmFkZHIpKTsNCglzZXJhZGRyLnNpbl9mYW1p
bHkgPSBBRl9JTkVUOw0KCS8vSVDlnLDlnYDovazmjaLlh73mlbDvvIzlj6/ku6XlnKjlsIZJUOWcsOWd
gOWcqOeCueWIhuWNgei/m+WItuWSjOS6jOi/m+WItuaVtOaVsOS5i+mXtOi9rOaNog0KCWluZXRfcHRv
bihBRl9JTkVULGlwLCZzZXJhZGRyLnNpbl9hZGRyKTsNCglzZXJhZGRyLnNpbl9wb3J0ID0gaHRvbnMo
cG9ydCk7DQoJLy9iaW5kIGEgbG9jYWwgbmFtZSB0byB0aGUgc29ja2V0Ow0KCWlmKGJpbmQobGlzdGVu
ZmQsIChzdHJ1Y3Qgc29ja2FkcnIqKSZzZXJhZGRyLCBzaXplb2Yoc2VyYWRkcikpID09IDEpDQoJew0K
CQlwZXJyb3IoImJpbmQgZXJyb3I6Iik7DQoJCWV4aXQoMSk7DQoJfQ0KDQoJcmV0dXJuIGxpc3RlbmZk
Ow0KfQ0KDQovL0lP5aSa6Lev5aSN55SoZXBvbGwNCnN0YXRpYyB2b2lkIGRvX2Vwb2xsKGludCBsaXN0
ZW5mZCkNCnsNCglpbnQgZXBvbGxmZDsNCglzdHJ1Y3QgZXBvbGxfZXZlbnQgZXZlbnRzW0VQT0xMRVZF
TlRTXTsNCglpbnQgcmV0Ow0KCWNoYXIgYnVmW01BWFNJWkVdOw0KCW1lbXNldChidWYsIDAgTUFYU0la
RSk7DQoJLy/liJvlu7rkuIDkuKrmj4/ov7DnrKYNCgllcG9sbGZkID0gZXBvbGxfY3JlYXRlKEZEU0la
RSk7DQoJYWRkX2V2ZW50KGVwb2xsZmQsIGxpc3RlbmZkLCBFUE9MTElOKTsNCglmb3IoOyA7KQ0KCXsN
CgkJLy/ojrflj5blt7Lnu4/lh4blpIflpb3nmoTmj4/ov7DnrKbkuovku7YNCgkJcmV0ID0gZXBvbGxf
d2FpdChlcG9sbGZkLCBldmVudHMsIEVQT0xMRVZFTlRTLCAtMSk7DQoJCWhhbmRsZV9ldmVudHMoZXBv
bGxmZCwgZXZlbnRzLHJldCwgbGlzdGVuZmQsIGJ1Zik7DQoJfQ0KCWNsb3NlKGVwb2xsZmQpOw0KfQ0K
DQovL+S6i+S7tuWkhOeQhuWHveaVsA0Kc3RhdGljIHZvaWQgaGFuZGxlX2V2ZW50cyhpbnQgZXBvbGxm
ZCwgc3RydWN0IGVwb2xsX2V2ZW50ICpldmVudHMsIGludCBudW0sIGludCBsaXN0ZW5mZCwgY2hhciAq
YnVmKQ0Kew0KCWludCBpOw0KCWludCBmZDsNCgkvL+i/m+ihjOmAieWlvemBjeWOhg0KCWZvcihpbnQg
aSA9IDA7IGkgPCBudW07IGkrKyl7DQoJCWZkID0gZXZlbnRzW2ldLmRhdGEuZmQ7DQoJCWlmKChmZCA9
PSBsaXN0ZW5mZCkgJiYgKGV2ZW50c1tpXS5ldmVudHMpICYgRVBPTExJTil7DQoJCQloYW5kbGVfYWNj
ZXB0KGVwb2xsZmQsIGxpc3RlbmZkKTsNCgkJfWVsc2UgaWYoZXZlbnRzW2ldLmV2ZW50cyAmIEVQT0xM
SU4pew0KCQkJZG9fcmVhZChlcG9sbGZkLCBmZCwgYnVmKTsNCgkJfWVsc2UgaWYoZXZlbnRzW2ldLmV2
ZW50cyAmIEVQT0xMT1VUKXsNCgkJCWRvX3dyaXRlKGVwb2xsZmQsIGZkLCBidWYpOw0KCQl9DQoJfQ0K
fQ0KDQovL+WkhOeQhuaOpeaUtueahOi/nuaOpQ0Kc3RhdGljIHZvaWQgaGFuZGxlX2FjY2VwdChpbnQg
ZXBvbGxmZCwgaW50IGxpc3RlbmVmZCl7DQoJaW50IGNsaWZkOw0KCXN0cnVjdCBzb2NrYWRkcl9pbiBj
bGlhZGRyOw0KCXNvY2tsZW5fdCBjbGlhZGRybGVuOw0KCWNsaWZkID0gYWNjZXB0KGxpc3RlbmZkLCAo
c3RydWN0IHNvY2thZGQqKSAmY2xpYWRkciwgJmNsaWFkZHJsZW4pOw0KCWlmKGNsaWZkID09IC0xKXsN
CgkJcGVycm9yKCJhY2NlcHQgZXJyb3I6Iik7DQoJfWVsc2Ugew0KCQlwcmludGYoImFjY2VwdCBhIG5l
dyBjbGllbnQgOiAlczolZFxuIixpbmV0X250b2EoY2xpYWRkci5zaW5fYWRkciksIGNsaWFkZHIuc2lu
X3BvcnQpOw0KCQkvL+a3u+WKoOS4gOS4quWuouaIt+err+aPj+i/sOespuWSjOS6i+S7tg0KCQlhZGRf
ZXZlbnQoZXBvbGxmZCwgY2xpZmQsIEVQT0xMSU4pOw0KCX0NCn0NCg0KLy/or7vmk43kvZwNCnN0YXRp
YyB2b2lkIGRvX3JlYWQoaW50IGVwb2xsZmQsIGludCBmZCwgY2hhciogYnVmKXsNCglpbnQgbnJlYWQ7
DQoJbnJlYWQgPSByZWFkKGZkLCBidWYsIE1BWFNJWkUpOw0KCWlmKG5yZWFkID09IC0xKXsNCgkJcGVy
cm9yKCJyZWFkIGVycm9yOiIpOw0KCQljbG9zZShmZCk7DQoJCWRlbGV0ZV9ldmVudChlcG9sbGZkLCBm
ZCwgRVBPTExJTik7DQoJfWVsc2UgaWYobnJlYWQgPT0gMCl7DQoJCWZwcmludGYoc3RkZXJyLCAiY2xp
ZW50IGNsb3NlLlxuIik7DQoJCWNsb3NlKGZkKTsNCgkJZGVsZXRlX2V2ZW50KGVwb2xsZmQsIGZkLCBF
UE9MTElOKTsNCgl9ZWxzZSB7DQoJCXByaW50ZigicmVhZCBtZXNzYWdlIGlzIDogJXNcbiIsYnVmICk7
DQoJCW1vZGlmeV9ldmVudChlcG9sbGZkLCBmZCwgRVBPTExPVVQpOw0KCX0NCn0NCg0KLy/lhpnmk43k
vZwNCnN0YXRpYyB2b2lkIGRvX3dyaXRlKGludCBlcG9sbGZkLCBpbnQgZmQsIGNoYXIqIGJ1Zil7DQoJ
aW50IG53cml0ZTsNCglud3JpdGUgPSB3cml0ZShmZCwgYnVmLCBzdHJsZW4oYnVmKSk7DQoJaWYobndy
aXRlID09IC0xKXsNCgkJcGVycm9yKCJ3cml0ZSBlcnJvcjoiKTsNCgkJY2xvc2UoZmQpOw0KCQlkZWxl
dGVfZXZlbnQoZXBvbGxmZCwgZmQsIEVQT0xMT1VUKTsNCgl9ZWxzZSB7DQoJCW1vZGlmeV9ldmVudChl
cG9sbGZkLCBmZCwgRVBPTExJTik7DQoJfQ0KCW1lbXNldChidWYsIDAsIE1BWFNJWkUpOw0KfQ0KDQov
L+a3u+WKoOS6i+S7tg0Kc3RhdGljIHZvaWQgYWRkX2V2ZW50KGludCBlcG9sbGZkLCBpbnQgZmQsIGlu
dCBzdGF0ZSl7DQoJc3RydWN0IGVwb2xsX2V2ZW50IGV2Ow0KCWV2LmV2ZW50cyA9IHN0YXRlOw0KCWV2
LmRhdGEuZmQgPSBmZDsNCgllcG9sbF9jdGwoZXBvbGxmZCwgRVBPTExfQ1RMX0FERCwgZmQsICZldik7
DQp9DQoNCi8v5L+u5pS55LqL5Lu2DQpzdGF0aWMgdm9pZCBtb2RpZnlfZXZlbnQoaW50IGVwb2xsZmQs
IGludCBmZCwgaW50IHN0YXRlKXsNCglzdHJ1Y3QgZXBvbGxfZXZlbnQgZXY7DQoJZXYuZXZlbnRzID0g
c3RhdGU7DQoJZXYuZGF0YS5mZCA9IGZkOw0KCWVwb2xsX2N0bChlcG9sbGZkLCBFUE9MTF9DVExfTU9E
LCBmZCwgJmV2KQ0KfQ0KDQovL+WIoOmZpOS6i+S7tg0Kc3RhdGljIHZvaWQgZGVsZXRlX2V2ZW50KGlu
dCBlcG9sbGZkLCBpbnQgZmQsIGludCBzdGF0ZSl7DQoJc3RydWN0IGVwb2xsX2V2ZW50IGV2Ow0KCWV2
LmV2ZW50cyA9IHN0YXRlOw0KCWV2LmRhdGEuZmQgPSBmZDsNCgllcG9sbF9jdGwoZXBvbGxmZCwgRVBP
TExfQ1RMX0RFTCwgZmQsICZldik7DQp9</data><mime>application/octet-stream</mime><duration>0</duration><resource-attributes><source-url>file://D:\android_framworksource\Android触摸事件的处理\epoll_server.cpp</source-url><timestamp>19700101T000000Z</timestamp><file-name>epoll_server.cpp</file-name><attachment>true</attachment></resource-attributes></resource></note>
</en-export>
